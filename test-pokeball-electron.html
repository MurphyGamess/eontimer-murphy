<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéæ Test Completo Electron - 27 Pokeballs con Efectos Master Ball y Shiny</title>
    <!-- CSS incluido directamente para Electron -->
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            font-family: 'Segoe UI', Arial, sans-serif;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255,255,255,0.3);
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .pokeball-card {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            position: relative;
        }
        
        .pokeball-card:hover {
            transform: translateY(-3px);
            border-color: rgba(255,255,255,0.4);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        
        .pokeball-icon {
            width: 50px;
            height: 50px;
            margin: 0 auto 10px;
            background-image: url('resources/sprites/pokeball-sprites-oficial.png');
            background-repeat: no-repeat;
            background-size: 1106px 680px; /* Dimensiones correctas para Electron */
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        .pokeball-card h4 {
            margin: 8px 0 5px 0;
            font-size: 14px;
        }
        
        .pokeball-card p {
            margin: 5px 0;
            font-size: 11px;
            opacity: 0.8;
        }
        
        .test-button {
            padding: 8px 12px;
            font-size: 11px;
            font-weight: bold;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 15px;
            cursor: pointer;
            margin: 2px;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .test-button:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
            transform: scale(1.05);
        }
        
        .special-tests {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            margin-bottom: 20px;
        }
        
        .info {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #ffd700;
        }
        
        /* Sprite de pokeball para animaci√≥n - POSICIONAMIENTO CORREGIDO */
        .pokeball-sprite-animated {
            position: fixed;
            width: 41px;
            height: 40px;
            z-index: 999999;
            pointer-events: none;
            background-image: url('resources/sprites/pokeball-sprites-oficial.png');
            background-repeat: no-repeat;
            background-size: 1106px 680px;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            transform-origin: center center;
        }
        
        /* Posiciones espec√≠ficas para cada pokeball (fila 0 = cerrada) */
        .sprite-pokeball { background-position: 0px 0px; }
        .sprite-greatball { background-position: -41px 0px; }
        .sprite-safariball { background-position: -82px 0px; }
        .sprite-ultraball { background-position: -123px 0px; }
        .sprite-masterball { background-position: -164px 0px; }
        .sprite-premierball { background-position: -205px 0px; }
        .sprite-repeatball { background-position: -246px 0px; }
        .sprite-timerball { background-position: -287px 0px; }
        .sprite-nestball { background-position: -328px 0px; }
        .sprite-netball { background-position: -369px 0px; }
        .sprite-diveball { background-position: -410px 0px; }
        .sprite-luxuryball { background-position: -451px 0px; }
        .sprite-healball { background-position: -492px 0px; }
        .sprite-quickball { background-position: -533px 0px; }
        .sprite-duskball { background-position: -574px 0px; }
        .sprite-cherishball { background-position: -615px 0px; }
        .sprite-fastball { background-position: -656px 0px; }
        .sprite-levelball { background-position: -697px 0px; }
        .sprite-lureball { background-position: -738px 0px; }
        .sprite-heavyball { background-position: -779px 0px; }
        .sprite-loveball { background-position: -820px 0px; }
        .sprite-friendball { background-position: -861px 0px; }
        .sprite-moonball { background-position: -902px 0px; }
        .sprite-sportball { background-position: -943px 0px; }
        .sprite-dreamball { background-position: -984px 0px; }
        .sprite-beastball { background-position: -1025px 0px; }
        .sprite-strangeball { background-position: -1066px 0px; }
        
        /* Iconos para las cartas */
        .icon-pokeball { background-position: 0px 0px; }
        .icon-greatball { background-position: -41px 0px; }
        .icon-safariball { background-position: -82px 0px; }
        .icon-ultraball { background-position: -123px 0px; }
        .icon-masterball { background-position: -164px 0px; }
        .icon-premierball { background-position: -205px 0px; }
        .icon-repeatball { background-position: -246px 0px; }
        .icon-timerball { background-position: -287px 0px; }
        .icon-nestball { background-position: -328px 0px; }
        .icon-netball { background-position: -369px 0px; }
        .icon-diveball { background-position: -410px 0px; }
        .icon-luxuryball { background-position: -451px 0px; }
        .icon-healball { background-position: -492px 0px; }
        .icon-quickball { background-position: -533px 0px; }
        .icon-duskball { background-position: -574px 0px; }
        .icon-cherishball { background-position: -615px 0px; }
        .icon-fastball { background-position: -656px 0px; }
        .icon-levelball { background-position: -697px 0px; }
        .icon-lureball { background-position: -738px 0px; }
        .icon-heavyball { background-position: -779px 0px; }
        .icon-loveball { background-position: -820px 0px; }
        .icon-friendball { background-position: -861px 0px; }
        .icon-moonball { background-position: -902px 0px; }
        .icon-sportball { background-position: -943px 0px; }
        .icon-dreamball { background-position: -984px 0px; }
        .icon-beastball { background-position: -1025px 0px; }
        .icon-strangeball { background-position: -1066px 0px; }
        
        /* Animaciones */
        @keyframes pokeball-fall {
            0% { 
                transform: translateY(-200px) rotate(0deg); 
                opacity: 0; 
            }
            50% { 
                opacity: 1; 
            }
            100% { 
                transform: translateY(0px) rotate(720deg); 
                opacity: 1; 
            }
        }
        
        /* Ca√≠da limpia SIN shake - para liberar pok√©mon */
        @keyframes pokeball-fall-clean {
            0% { 
                transform: translateY(-150px) scale(0.8); 
                opacity: 0; 
            }
            70% { 
                opacity: 1; 
                transform: translateY(10px) scale(1.05); 
            }
            100% { 
                transform: translateY(0px) scale(1); 
                opacity: 1; 
            }
        }
        
        /* Shake solo para captura (no usado ahora) */
        @keyframes pokeball-shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-5deg); }
            75% { transform: translateX(5px) rotate(5deg); }
        }
        
        .stats {
            font-size: 10px;
            color: #ccc;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéæ Test Completo Electron - 27 Pokeballs</h1>
        <p>Animaci√≥n frame por frame con efectos Master Ball y Shiny ‚ú®</p>
    </div>
    
    <div class="info">
        <h3>üé¨ Secuencia de Animaci√≥n Frame por Frame:</h3>
        <p>‚Ä¢ <strong>Frame 1</strong> ‚Üí Pokeball cerrada (ca√≠da y agitaci√≥n)</p>
        <p>‚Ä¢ <strong>Frames 1‚Üí11</strong> ‚Üí Animaci√≥n de apertura suave (80ms por frame)</p>
        <p>‚Ä¢ <strong>Frame 11</strong> ‚Üí Pokeball completamente abierta + efectos especiales</p>
        <p>‚Ä¢ <strong>Pok√©mon aparece</strong> ‚Üí Mensaje simulado</p>
        <p>‚Ä¢ <strong>Frames 11‚Üí1</strong> ‚Üí Animaci√≥n de cierre reversa</p>
        <br>
        <h3>‚ú® Efectos Shiny Personalizados por Pokeball:</h3>
        <p>‚Ä¢ <strong>Pokeball Shiny</strong> ‚Üí Explosi√≥n dorada-roja + estrellas rojas/blancas</p>
        <p>‚Ä¢ <strong>Great Ball Shiny</strong> ‚Üí Explosi√≥n dorada-azul + ondas azules</p>
        <p>‚Ä¢ <strong>Ultra Ball Shiny</strong> ‚Üí Explosi√≥n dorada-negra + rayos dorados en cruz</p>
        <p>‚Ä¢ <strong>Quick Ball Shiny</strong> ‚Üí Explosi√≥n dorada-cyan + rel√°mpagos ‚ö°</p>
        <p>‚Ä¢ <strong>Luxury Ball Shiny</strong> ‚Üí Explosi√≥n dorada + diamantes üíé</p>
        <p>‚Ä¢ <strong>Love Ball Shiny</strong> ‚Üí Explosi√≥n dorada-rosa + corazones üíñ</p>
        <p>‚Ä¢ <strong>Moon Ball Shiny</strong> ‚Üí Explosi√≥n dorada-p√∫rpura + fases lunares üåô</p>
        <p>‚Ä¢ <strong>Otras pokeballs</strong> ‚Üí Explosi√≥n dorada + part√≠culas de su color espec√≠fico</p>
    </div>
    
    <div class="special-tests">
        <h3>üåü Tests Especiales</h3>
        <button class="test-button" onclick="testRandomPokeball()">üé≤ Pokeball Aleatoria</button>
        <button class="test-button" onclick="testPokeballShowcase()">üé≠ Showcase (5 aleatorias)</button>
        <button class="test-button" onclick="testPokeballRain()">üåßÔ∏è Lluvia √âpica (10 pokeballs)</button>
        <button class="test-button" onclick="testAllMainPokeballs()">üèÜ Las 4 Principales</button>
        <button class="test-button" onclick="testOnlyEffects()">‚ú® Solo Efectos Master Ball</button>
        <button class="test-button" onclick="testShinyEffectsShowcase()">üåü Showcase Efectos Shiny</button>
        <button class="test-button" onclick="testCaptureVsRelease()">‚öîÔ∏è Captura vs Liberaci√≥n</button>
    </div>
    
    <div class="special-tests">
        <h3>üîç Herramientas de Medici√≥n</h3>
        <button class="test-button" onclick="measureSpritesheet()">üìê Medir Spritesheet (Console)</button>
        <button class="test-button" onclick="testSpritePositions()">üß™ Test Posiciones (Flechas + ESC)</button>
        <button class="test-button" onclick="showSpritesheetStructure()">üìã Mostrar Estructura (27x11)</button>
        <p style="font-size: 12px; opacity: 0.8; margin-top: 10px;">
            üí° Usa F12 para abrir la consola y ver las mediciones
        </p>
    </div>
    
    <div class="test-grid" id="pokeballGrid">
        <!-- Las 27 pokeballs se generar√°n con JavaScript -->
    </div>
    
    <script src="assets/js/pokeball-effects.js"></script>
    <script>

        
        // üéæ MAPEO COMPLETO DE LAS 27 POKEBALLS
        const pokeballDatabase = [
            { id: 'pokeball', name: 'Pok√© Ball', description: 'Pok√©mon normales', xPos: 0, color: '#ff4444' },
            { id: 'greatball', name: 'Great Ball', description: 'Pok√©mon poco comunes', xPos: -41, color: '#4488ff' },
            { id: 'safariball', name: 'Safari Ball', description: 'Zona Safari', xPos: -82, color: '#99cc33' },
            { id: 'ultraball', name: 'Ultra Ball', description: 'Pok√©mon raros', xPos: -123, color: '#666666' },
            { id: 'masterball', name: 'Master Ball', description: 'Legendarios y Shiny', xPos: -164, color: '#8844ff' },
            { id: 'premierball', name: 'Premier Ball', description: 'Pok√©mon especiales', xPos: -205, color: '#ffffff' },
            { id: 'repeatball', name: 'Repeat Ball', description: 'Pok√©mon ya capturados', xPos: -246, color: '#ffaa00' },
            { id: 'timerball', name: 'Timer Ball', description: 'Aumenta con tiempo', xPos: -287, color: '#888888' },
            { id: 'nestball', name: 'Nest Ball', description: 'Pok√©mon de nivel bajo', xPos: -328, color: '#88aa00' },
            { id: 'netball', name: 'Net Ball', description: 'Tipos Water/Bug', xPos: -369, color: '#44aacc' },
            { id: 'diveball', name: 'Dive Ball', description: 'Pok√©mon submarinos', xPos: -410, color: '#0088cc' },
            { id: 'luxuryball', name: 'Luxury Ball', description: 'Aumenta amistad', xPos: -451, color: '#cc9900' },
            { id: 'healball', name: 'Heal Ball', description: 'Cura al capturar', xPos: -492, color: '#ff88aa' },
            { id: 'quickball', name: 'Quick Ball', description: 'Capturas r√°pidas', xPos: -533, color: '#44ffff' },
            { id: 'duskball', name: 'Dusk Ball', description: 'Tipos Dark/Ghost', xPos: -574, color: '#446644' },
            { id: 'cherishball', name: 'Cherish Ball', description: 'Eventos especiales', xPos: -615, color: '#ff4488' },
            { id: 'fastball', name: 'Fast Ball', description: 'Pok√©mon r√°pidos', xPos: -656, color: '#ffcc00' },
            { id: 'levelball', name: 'Level Ball', description: 'Pok√©mon de menor nivel', xPos: -697, color: '#ff6600' },
            { id: 'lureball', name: 'Lure Ball', description: 'Pok√©mon pescados', xPos: -738, color: '#0066cc' },
            { id: 'heavyball', name: 'Heavy Ball', description: 'Pok√©mon pesados', xPos: -779, color: '#666666' },
            { id: 'loveball', name: 'Love Ball', description: 'G√©nero opuesto', xPos: -820, color: '#ff66cc' },
            { id: 'friendball', name: 'Friend Ball', description: 'Aumenta amistad inicial', xPos: -861, color: '#66cc66' },
            { id: 'moonball', name: 'Moon Ball', description: 'Evoluci√≥n por piedra lunar', xPos: -902, color: '#6666cc' },
            { id: 'sportball', name: 'Sport Ball', description: 'Concurso de captura', xPos: -943, color: '#cc6600' },
            { id: 'dreamball', name: 'Dream Ball', description: 'Mundo de los sue√±os', xPos: -984, color: '#ff88cc' },
            { id: 'beastball', name: 'Beast Ball', description: 'Ultra Entes', xPos: -1025, color: '#4444ff' },
            { id: 'strangeball', name: 'Strange Ball', description: 'Leyendas Arceus', xPos: -1066, color: '#888844' }
        ];
        
        // üåü EFECTOS AVANZADOS DE MASTER BALL
        const advancedEffects = {
            createMasterBallStarsEffect(position) {
                this.createMasterBallBase(position);
                this.createGoldenStars(position);
                this.createPurpleAura(position);
                this.createSparkleRain(position);
            },
            
            createShinyMasterBallEffect(position, pokemonName) {
                this.createMasterBallStarsEffect(position);
                this.createShinyExplosion(position);
                setTimeout(() => {
                    this.createShinyText(pokemonName);
                }, 500);
            },
            
            createMasterBallBase(position) {
                // Resplandor central p√∫rpura
                const centralGlow = document.createElement('div');
                centralGlow.style.cssText = `
                    position: fixed;
                    left: ${position.x - 60}px;
                    top: ${position.y - 60}px;
                    width: 120px;
                    height: 120px;
                    background: radial-gradient(circle, 
                        #9932CC88 0%, 
                        #8844ff66 30%, 
                        #FFD70044 60%, 
                        transparent 100%);
                    border-radius: 50%;
                    z-index: 999998;
                    pointer-events: none;
                    animation: masterBallPulse 2s ease-out forwards;
                `;
                document.body.appendChild(centralGlow);
                setTimeout(() => centralGlow.remove(), 2000);
            },
            
            createGoldenStars(position) {
                // 15 estrellas doradas grandes
                for(let i = 0; i < 15; i++) {
                    setTimeout(() => {
                        const star = document.createElement('div');
                        const angle = (i * 24) + Math.random() * 15; // Distribuci√≥n circular
                        const distance = 80 + Math.random() * 100;
                        const size = 8 + Math.random() * 12;
                        
                        star.innerHTML = '‚òÖ';
                        star.style.cssText = `
                            position: fixed;
                            left: ${position.x + Math.cos(angle * Math.PI / 180) * distance}px;
                            top: ${position.y + Math.sin(angle * Math.PI / 180) * distance}px;
                            font-size: ${size}px;
                            color: #FFD700;
                            z-index: 999999;
                            pointer-events: none;
                            text-shadow: 0 0 10px #FFD700, 0 0 20px #FFD700;
                            animation: goldenStarBurst 3s ease-out forwards;
                            transform-origin: center;
                        `;
                        document.body.appendChild(star);
                        setTimeout(() => star.remove(), 3000);
                    }, i * 100);
                }
            },
            
            createPurpleAura(position) {
                // Aura p√∫rpura expansiva
                for(let i = 0; i < 8; i++) {
                    setTimeout(() => {
                        const aura = document.createElement('div');
                        const scale = 1 + i * 0.3;
                        
                        aura.style.cssText = `
                            position: fixed;
                            left: ${position.x - 40 * scale}px;
                            top: ${position.y - 40 * scale}px;
                            width: ${80 * scale}px;
                            height: ${80 * scale}px;
                            background: radial-gradient(circle, 
                                transparent 40%, 
                                #9932CC33 50%, 
                                #9932CC66 60%, 
                                transparent 100%);
                            border-radius: 50%;
                            z-index: 999997;
                            pointer-events: none;
                            animation: purpleWave 2s ease-out forwards;
                        `;
                        document.body.appendChild(aura);
                        setTimeout(() => aura.remove(), 2000);
                    }, i * 200);
                }
            },
            
            createSparkleRain(position) {
                // Lluvia de part√≠culas brillantes
                for(let i = 0; i < 25; i++) {
                    setTimeout(() => {
                        const sparkle = document.createElement('div');
                        const xOffset = (Math.random() - 0.5) * 300;
                        const yOffset = (Math.random() - 0.5) * 200;
                        const isGold = Math.random() > 0.4;
                        
                        sparkle.innerHTML = isGold ? '‚ú¶' : '‚óÜ';
                        sparkle.style.cssText = `
                            position: fixed;
                            left: ${position.x + xOffset}px;
                            top: ${position.y + yOffset - 100}px;
                            font-size: ${4 + Math.random() * 8}px;
                            color: ${isGold ? '#FFD700' : '#9932CC'};
                            z-index: 999999;
                            pointer-events: none;
                            text-shadow: 0 0 5px currentColor;
                            animation: sparklefall 4s ease-out forwards;
                        `;
                        document.body.appendChild(sparkle);
                        setTimeout(() => sparkle.remove(), 4000);
                    }, i * 150);
                }
            },
            
            createShinyExplosion(position) {
                // Explosi√≥n especial para shinies (versi√≥n original Master Ball)
                const explosion = document.createElement('div');
                explosion.style.cssText = `
                    position: fixed;
                    left: ${position.x - 100}px;
                    top: ${position.y - 100}px;
                    width: 200px;
                    height: 200px;
                    background: radial-gradient(circle, 
                        #FFD700 0%, 
                        #FFA500 20%,
                        #9932CC 40%,
                        #8844ff 60%,
                        transparent 100%);
                    border-radius: 50%;
                    z-index: 999999;
                    pointer-events: none;
                    animation: shinyExplosion 2s ease-out forwards;
                `;
                document.body.appendChild(explosion);
                setTimeout(() => explosion.remove(), 2000);
            },
            
            createCustomShinyExplosion(position, pokeballColor, ballType) {
                // üåü EXPLOSI√ìN SHINY PERSONALIZADA POR POKEBALL
                console.log(`‚ú® Creating custom shiny explosion for ${ballType} with color ${pokeballColor}`);
                
                // Explosi√≥n principal (dorada + color espec√≠fico de la pokeball)
                const explosion = document.createElement('div');
                explosion.style.cssText = `
                    position: fixed;
                    left: ${position.x - 100}px;
                    top: ${position.y - 100}px;
                    width: 200px;
                    height: 200px;
                    background: radial-gradient(circle, 
                        #FFD700 0%, 
                        #FFA500 15%,
                        ${pokeballColor}88 35%,
                        ${pokeballColor}66 55%,
                        transparent 100%);
                    border-radius: 50%;
                    z-index: 999999;
                    pointer-events: none;
                    animation: shinyExplosion 2s ease-out forwards;
                `;
                document.body.appendChild(explosion);
                setTimeout(() => explosion.remove(), 2000);
                
                // Efectos espec√≠ficos adicionales seg√∫n el tipo de pokeball
                this.createBallSpecificShinyEffects(position, pokeballColor, ballType);
            },
            
            createBallSpecificShinyEffects(position, pokeballColor, ballType) {
                // üé® EFECTOS ESPEC√çFICOS POR TIPO DE POKEBALL EN MODO SHINY
                switch(ballType) {
                    case 'pokeball':
                        this.createRedWhiteShinyEffect(position);
                        break;
                    case 'greatball':
                        this.createBlueShinyEffect(position);
                        break;
                    case 'ultraball':
                        this.createBlackGoldShinyEffect(position);
                        break;
                    case 'quickball':
                        this.createLightningShinyEffect(position);
                        break;
                    case 'timerball':
                        this.createClockShinyEffect(position);
                        break;
                    case 'duskball':
                        this.createShadowShinyEffect(position);
                        break;
                    case 'luxuryball':
                        this.createLuxuryShinyEffect(position);
                        break;
                    case 'moonball':
                        this.createMoonShinyEffect(position);
                        break;
                    case 'loveball':
                        this.createHeartShinyEffect(position);
                        break;
                    case 'dreamball':
                        this.createDreamShinyEffect(position);
                        break;
                    case 'beastball':
                        this.createBeastShinyEffect(position);
                        break;
                    default:
                        // Efecto gen√©rico con el color de la pokeball
                        this.createGenericShinyEffect(position, pokeballColor);
                        break;
                }
            },
            
            // üî• EFECTOS ESPEC√çFICOS PARA CADA POKEBALL SHINY
            createRedWhiteShinyEffect(position) {
                // Pokeball: Estrellas rojas y blancas alternadas
                for(let i = 0; i < 8; i++) {
                    const star = document.createElement('div');
                    const angle = i * 45;
                    const distance = 80 + Math.random() * 60;
                    const isRed = i % 2 === 0;
                    
                    star.innerHTML = '‚òÖ';
                    star.style.cssText = `
                        position: fixed;
                        left: ${position.x + Math.cos(angle * Math.PI / 180) * distance}px;
                        top: ${position.y + Math.sin(angle * Math.PI / 180) * distance}px;
                        font-size: ${12 + Math.random() * 8}px;
                        color: ${isRed ? '#FF4444' : '#FFFFFF'};
                        z-index: 999999;
                        pointer-events: none;
                        text-shadow: 0 0 8px currentColor;
                        animation: goldenStarBurst 2.5s ease-out forwards;
                    `;
                    document.body.appendChild(star);
                    setTimeout(() => star.remove(), 2500);
                }
            },
            
            createBlueShinyEffect(position) {
                // Great Ball: Ondas azules conc√©ntricas
                for(let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        const wave = document.createElement('div');
                        wave.style.cssText = `
                            position: fixed;
                            left: ${position.x - 50}px;
                            top: ${position.y - 50}px;
                            width: 100px;
                            height: 100px;
                            border: 3px solid #4488FF;
                            border-radius: 50%;
                            z-index: 999998;
                            pointer-events: none;
                            animation: purpleWave 2s ease-out forwards;
                        `;
                        document.body.appendChild(wave);
                        setTimeout(() => wave.remove(), 2000);
                    }, i * 200);
                }
            },
            
            createBlackGoldShinyEffect(position) {
                // Ultra Ball: Rayos dorados en cruz
                const directions = [0, 90, 180, 270];
                directions.forEach(angle => {
                    const ray = document.createElement('div');
                    ray.style.cssText = `
                        position: fixed;
                        left: ${position.x}px;
                        top: ${position.y}px;
                        width: 150px;
                        height: 6px;
                        background: linear-gradient(90deg, #FFD700, #666666, transparent);
                        transform-origin: 0 50%;
                        transform: rotate(${angle}deg);
                        z-index: 999998;
                        pointer-events: none;
                        animation: goldenStarBurst 2s ease-out forwards;
                    `;
                    document.body.appendChild(ray);
                    setTimeout(() => ray.remove(), 2000);
                });
            },
            
            createLightningShinyEffect(position) {
                // Quick Ball: Rel√°mpagos azul claro
                for(let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        const lightning = document.createElement('div');
                        lightning.innerHTML = '‚ö°';
                        lightning.style.cssText = `
                            position: fixed;
                            left: ${position.x + (Math.random() - 0.5) * 100}px;
                            top: ${position.y + (Math.random() - 0.5) * 100}px;
                            font-size: 30px;
                            color: #44FFFF;
                            z-index: 999999;
                            pointer-events: none;
                            text-shadow: 0 0 15px #44FFFF;
                            animation: sparklefall 1.5s ease-out forwards;
                        `;
                        document.body.appendChild(lightning);
                        setTimeout(() => lightning.remove(), 1500);
                    }, i * 300);
                }
            },
            
            createLuxuryShinyEffect(position) {
                // Luxury Ball: Part√≠culas doradas de lujo
                for(let i = 0; i < 12; i++) {
                    setTimeout(() => {
                        const luxury = document.createElement('div');
                        luxury.innerHTML = 'üíé';
                        luxury.style.cssText = `
                            position: fixed;
                            left: ${position.x + (Math.random() - 0.5) * 150}px;
                            top: ${position.y + (Math.random() - 0.5) * 150}px;
                            font-size: ${15 + Math.random() * 10}px;
                            color: #CC9900;
                            z-index: 999999;
                            pointer-events: none;
                            text-shadow: 0 0 10px #FFD700;
                            animation: sparklefall 3s ease-out forwards;
                        `;
                        document.body.appendChild(luxury);
                        setTimeout(() => luxury.remove(), 3000);
                    }, i * 150);
                }
            },
            
            createHeartShinyEffect(position) {
                // Love Ball: Corazones rosas
                for(let i = 0; i < 6; i++) {
                    setTimeout(() => {
                        const heart = document.createElement('div');
                        heart.innerHTML = 'üíñ';
                        heart.style.cssText = `
                            position: fixed;
                            left: ${position.x + (Math.random() - 0.5) * 120}px;
                            top: ${position.y + (Math.random() - 0.5) * 120}px;
                            font-size: 20px;
                            z-index: 999999;
                            pointer-events: none;
                            animation: sparklefall 2.5s ease-out forwards;
                        `;
                        document.body.appendChild(heart);
                        setTimeout(() => heart.remove(), 2500);
                    }, i * 200);
                }
            },
            
                         createClockShinyEffect(position) {
                // Timer Ball: N√∫meros de reloj dorados girando
                const clockNumbers = ['12', '3', '6', '9'];
                clockNumbers.forEach((num, i) => {
                    setTimeout(() => {
                        const clock = document.createElement('div');
                        clock.textContent = num;
                        clock.style.cssText = `
                            position: fixed;
                            left: ${position.x + Math.cos(i * 90 * Math.PI / 180) * 90}px;
                            top: ${position.y + Math.sin(i * 90 * Math.PI / 180) * 90}px;
                            font-size: 18px;
                            color: #888888;
                            font-weight: bold;
                            z-index: 999999;
                            pointer-events: none;
                            text-shadow: 0 0 8px #FFD700;
                            animation: goldenStarBurst 2.5s ease-out forwards;
                        `;
                        document.body.appendChild(clock);
                        setTimeout(() => clock.remove(), 2500);
                    }, i * 200);
                });
            },
            
            createShadowShinyEffect(position) {
                // Dusk Ball: Sombras p√∫rpuras m√≠sticas
                for(let i = 0; i < 6; i++) {
                    setTimeout(() => {
                        const shadow = document.createElement('div');
                        shadow.innerHTML = 'üåô';
                        shadow.style.cssText = `
                            position: fixed;
                            left: ${position.x + (Math.random() - 0.5) * 140}px;
                            top: ${position.y + (Math.random() - 0.5) * 140}px;
                            font-size: 20px;
                            filter: hue-rotate(${Math.random() * 60}deg);
                            z-index: 999999;
                            pointer-events: none;
                            animation: sparklefall 3s ease-out forwards;
                        `;
                        document.body.appendChild(shadow);
                        setTimeout(() => shadow.remove(), 3000);
                    }, i * 250);
                }
            },
            
            createMoonShinyEffect(position) {
                // Moon Ball: Fases lunares brillantes
                const moonPhases = ['üåë', 'üåí', 'üåì', 'üåî', 'üåï', 'üåñ', 'üåó', 'üåò'];
                moonPhases.forEach((phase, i) => {
                    setTimeout(() => {
                        const moon = document.createElement('div');
                        moon.innerHTML = phase;
                        moon.style.cssText = `
                            position: fixed;
                            left: ${position.x + Math.cos(i * 45 * Math.PI / 180) * 100}px;
                            top: ${position.y + Math.sin(i * 45 * Math.PI / 180) * 100}px;
                            font-size: 22px;
                            z-index: 999999;
                            pointer-events: none;
                            text-shadow: 0 0 15px #6666CC;
                            animation: goldenStarBurst 3s ease-out forwards;
                        `;
                        document.body.appendChild(moon);
                        setTimeout(() => moon.remove(), 3000);
                    }, i * 150);
                });
            },
            
            createDreamShinyEffect(position) {
                // Dream Ball: Nubes de sue√±o rosadas
                for(let i = 0; i < 8; i++) {
                    setTimeout(() => {
                        const dream = document.createElement('div');
                        dream.innerHTML = '‚òÅÔ∏è';
                        dream.style.cssText = `
                            position: fixed;
                            left: ${position.x + (Math.random() - 0.5) * 160}px;
                            top: ${position.y + (Math.random() - 0.5) * 160}px;
                            font-size: 18px;
                            filter: hue-rotate(300deg) saturate(1.5);
                            z-index: 999999;
                            pointer-events: none;
                            animation: sparklefall 4s ease-out forwards;
                        `;
                        document.body.appendChild(dream);
                        setTimeout(() => dream.remove(), 4000);
                    }, i * 200);
                }
            },
            
            createBeastShinyEffect(position) {
                // Beast Ball: Energ√≠a ultravioleta
                for(let i = 0; i < 10; i++) {
                    setTimeout(() => {
                        const beast = document.createElement('div');
                        beast.innerHTML = '‚ö°';
                        beast.style.cssText = `
                            position: fixed;
                            left: ${position.x + (Math.random() - 0.5) * 120}px;
                            top: ${position.y + (Math.random() - 0.5) * 120}px;
                            font-size: 16px;
                            color: #4444FF;
                            z-index: 999999;
                            pointer-events: none;
                            text-shadow: 0 0 12px #8800FF;
                            animation: sparklefall 2s ease-out forwards;
                        `;
                        document.body.appendChild(beast);
                        setTimeout(() => beast.remove(), 2000);
                    }, i * 100);
                }
            },
            
            createGenericShinyEffect(position, color) {
                // Efecto gen√©rico usando el color espec√≠fico de la pokeball
                for(let i = 0; i < 8; i++) {
                    const sparkle = document.createElement('div');
                    const angle = i * 45;
                    const distance = 70 + Math.random() * 50;
                    
                    sparkle.innerHTML = '‚ú¶';
                    sparkle.style.cssText = `
                        position: fixed;
                        left: ${position.x + Math.cos(angle * Math.PI / 180) * distance}px;
                        top: ${position.y + Math.sin(angle * Math.PI / 180) * distance}px;
                        font-size: ${10 + Math.random() * 8}px;
                        color: ${color};
                        z-index: 999999;
                        pointer-events: none;
                        text-shadow: 0 0 8px currentColor, 0 0 15px #FFD700;
                        animation: goldenStarBurst 2s ease-out forwards;
                    `;
                    document.body.appendChild(sparkle);
                    setTimeout(() => sparkle.remove(), 2000);
                }
            },
            
            createShinyText(pokemonName) {
                const shinyText = document.createElement('div');
                shinyText.innerHTML = '‚ú® ¬°SHINY! ‚ú®';
                shinyText.style.cssText = `
                    position: fixed;
                    top: 20%;
                    left: 50%;
                    transform: translateX(-50%);
                    font-size: 32px;
                    font-weight: bold;
                    color: #FFD700;
                    text-shadow: 
                        0 0 10px #FFD700,
                        0 0 20px #FFD700,
                        0 0 30px #9932CC;
                    z-index: 1000000;
                    pointer-events: none;
                    animation: shinyTextGlow 3s ease-out forwards;
                `;
                document.body.appendChild(shinyText);
                setTimeout(() => shinyText.remove(), 3000);
            }
        };

        // Inicializar sistema de efectos
        document.addEventListener('DOMContentLoaded', () => {
            console.log('‚úÖ Master Ball Advanced Effects loaded');
            
            // Generar grid de pokeballs
            generatePokeballGrid();
            
            // AUTO-DETECCI√ìN Y CORRECCI√ìN DE SPRITESHEET
            autoFixSpritesheet();
        });
        
        // üîß AUTO-CORRECCI√ìN DEL SPRITESHEET
        function autoFixSpritesheet() {
            const testImg = new Image();
            testImg.onload = function() {
                const width = this.naturalWidth;
                const height = this.naturalHeight;
                
                console.log(`üîß Auto-fix: Detectado spritesheet ${width}x${height}px`);
                
                // Si las dimensiones son diferentes a las esperadas, corregir
                if (width !== 1106 || height !== 680) {
                    const correctSize = `${width}px ${height}px`;
                    
                    // Actualizar CSS din√°micamente
                    const style = document.createElement('style');
                    style.textContent = `
                        .pokeball-icon,
                        .pokeball-sprite-animated {
                            background-size: ${correctSize} !important;
                        }
                    `;
                    document.head.appendChild(style);
                    
                    console.log(`‚úÖ Spritesheet corregido autom√°ticamente a ${correctSize}`);
                } else {
                    console.log('‚úÖ Dimensiones del spritesheet son correctas');
                }
            };
            testImg.onerror = function() {
                console.error('‚ùå No se pudo cargar el spritesheet. Verifica la ruta.');
                
                // Mostrar mensaje de error en la p√°gina
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: rgba(255,0,0,0.9);
                    color: white;
                    padding: 15px;
                    border-radius: 8px;
                    z-index: 999999;
                    font-family: monospace;
                    max-width: 300px;
                `;
                errorDiv.innerHTML = `
                    <strong>‚ùå Error de Spritesheet</strong><br>
                    No se encontr√≥: <br>
                    <code>resources/sprites/pokeball-sprites-oficial.png</code>
                `;
                document.body.appendChild(errorDiv);
                
                setTimeout(() => errorDiv.remove(), 5000);
            };
            testImg.src = 'resources/sprites/pokeball-sprites-oficial.png';
        }
        
        // Generar las 27 cartas de pokeball
        function generatePokeballGrid() {
            const grid = document.getElementById('pokeballGrid');
            
            pokeballDatabase.forEach(pokeball => {
                const card = document.createElement('div');
                card.className = 'pokeball-card';
                card.innerHTML = `
                    <div class="pokeball-icon icon-${pokeball.id}"></div>
                    <h4>${pokeball.name}</h4>
                    <p>${pokeball.description}</p>
                    <button class="test-button" onclick="testPokeball('${pokeball.id}', 'Pikachu', false)">Test Normal</button>
                    <button class="test-button" onclick="testPokeball('${pokeball.id}', 'Pikachu', true)">Test Shiny</button>
                    <div class="stats">xPos: ${pokeball.xPos}px</div>
                `;
                grid.appendChild(card);
            });
        }
        
        // üé¨ FUNCI√ìN PRINCIPAL PARA PROBAR POKEBALLS
        function testPokeball(ballType, pokemonName = 'Pikachu', isShiny = false, customPosition = null) {
            console.log(`üß™ Testing ${ballType.toUpperCase()} for ${pokemonName} (shiny: ${isShiny})`);
            
            const position = customPosition || {
                x: window.innerWidth / 2,
                y: window.innerHeight / 2
            };
            
            // Crear secuencia completa con animaci√≥n frame por frame
            createFrameByFramePokeballSequence(ballType, position, pokemonName, isShiny);
        }
        
        // üé¨ SECUENCIA COMPLETA CON ANIMACI√ìN SINCRONIZADA
        function createFrameByFramePokeballSequence(ballType, position, pokemonName, isShiny) {
            const pokeballData = pokeballDatabase.find(p => p.id === ballType);
            if (!pokeballData) {
                console.error(`‚ùå Pokeball type '${ballType}' not found!`);
                return;
            }
            
            console.log(`üé¨ Starting synchronized fall + opening for ${pokeballData.name}`);
            
            // CREAR SPRITE INICIAL (FRAME 1 - CERRADA)
            const sprite = document.createElement('div');
            sprite.className = `pokeball-sprite-animated sprite-${ballType}`;
            sprite.style.cssText = `
                position: fixed;
                left: ${position.x - 20}px;
                top: ${position.y - 150}px;
                width: 41px;
                height: 40px;
                z-index: 999999;
                pointer-events: none;
                background-position: ${pokeballData.xPos}px 0px;
            `;
            
            document.body.appendChild(sprite);
            
            // FASE COMBINADA: CA√çDA + APERTURA FRAME POR FRAME SIMULT√ÅNEA
            console.log('üéûÔ∏è Fall + frame-by-frame opening synchronized');
            animateFallWithFrames(sprite, pokeballData, position, () => {
                
                // FASE 2: EFECTOS ESPECIALES (ya est√° abierta al llegar al suelo)
                createPokeballOpenEffects(ballType, position, pokemonName, isShiny);
                
                setTimeout(() => {
                    // FASE 3: MENSAJE POK√âMON
                    console.log('üêæ Pok√©mon emerges from opened pokeball!');
                    showPokemonMessage(pokemonName, isShiny);
                    
                    setTimeout(() => {
                        // FASE 4: ANIMACI√ìN FRAME POR FRAME CIERRE (11‚Üí1)
                        console.log('üîÑ Frame-by-frame closing animation');
                        animateFrameByFrame(sprite, pokeballData, 11, 1, 60, () => {
                            
                            // FASE 5: LIMPIAR
                            sprite.remove();
                            console.log('‚úÖ Synchronized sequence completed');
                        });
                    }, 2000);
                }, 1000);
            });
        }
        
        // üéØ ANIMACI√ìN SINCRONIZADA: CA√çDA + FRAMES
        function animateFallWithFrames(sprite, pokeballData, finalPosition, onComplete) {
            const fallDuration = 1500; // 1.5 segundos de ca√≠da
            const frameCount = 11;
            const frameInterval = fallDuration / frameCount; // ~136ms por frame
            
            let currentFrame = 1;
            let startTime = Date.now();
            let fallStartY = finalPosition.y - 150; // Posici√≥n inicial (arriba)
            let fallEndY = finalPosition.y - 60;    // Posici√≥n final (abajo)
            
            console.log(`üéØ Sync: ${fallDuration}ms fall + ${frameCount} frames = ${frameInterval}ms per frame`);
            
            const animateSync = () => {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / fallDuration, 1); // 0 a 1
                
                // CALCULAR POSICI√ìN Y (ca√≠da con easing)
                const easeOut = 1 - Math.pow(1 - progress, 3); // Easing suave
                const currentY = fallStartY + (fallEndY - fallStartY) * easeOut;
                
                // CALCULAR FRAME ACTUAL basado en el progreso
                const targetFrame = Math.min(Math.floor(progress * frameCount) + 1, frameCount);
                
                // ACTUALIZAR FRAME si cambi√≥
                if (targetFrame !== currentFrame) {
                    currentFrame = targetFrame;
                    const yPos = (currentFrame - 1) * -40;
                    sprite.style.backgroundPosition = `${pokeballData.xPos}px ${yPos}px`;
                    console.log(`   Fall progress: ${Math.round(progress * 100)}% ‚Üí Frame ${currentFrame}`);
                }
                
                // ACTUALIZAR POSICI√ìN Y
                sprite.style.top = `${currentY}px`;
                
                // CONTINUAR HASTA COMPLETAR
                if (progress < 1) {
                    requestAnimationFrame(animateSync);
                } else {
                    console.log(`‚úÖ Fall completed! Pokeball opened during fall (Frame ${currentFrame})`);
                    if (onComplete) onComplete();
                }
            };
            
            animateSync();
        }
        
        // üéûÔ∏è ANIMACI√ìN FRAME POR FRAME SUAVE (SOLO 11 FRAMES POR POKEBALL)
        function animateFrameByFrame(sprite, pokeballData, startFrame, endFrame, frameTime, onComplete) {
            // LIMITAR A 11 FRAMES M√ÅXIMO POR POKEBALL
            const maxFrames = 11;
            startFrame = Math.max(1, Math.min(startFrame, maxFrames));
            endFrame = Math.max(1, Math.min(endFrame, maxFrames));
            
            let currentFrame = startFrame;
            const direction = startFrame < endFrame ? 1 : -1;
            
            console.log(`üéûÔ∏è Animando ${pokeballData.name}: Frame ${startFrame} ‚Üí ${endFrame} (m√°x: ${maxFrames})`);
            
            const animate = () => {
                // ASEGURAR que currentFrame est√© dentro del rango v√°lido (1-11)
                currentFrame = Math.max(1, Math.min(currentFrame, maxFrames));
                
                // Calcular posici√≥n Y basada en el frame actual (0-based)
                const yPos = (currentFrame - 1) * -40; // Frame 1 = 0px, Frame 2 = -40px, etc.
                sprite.style.backgroundPosition = `${pokeballData.xPos}px ${yPos}px`;
                
                console.log(`   Frame ${currentFrame}: position ${pokeballData.xPos}px ${yPos}px`);
                
                // Verificar si hemos llegado al frame final
                if (currentFrame === endFrame) {
                    console.log(`‚úÖ Animaci√≥n completada en frame ${endFrame}`);
                    if (onComplete) onComplete();
                    return;
                }
                
                // Avanzar al siguiente frame (con l√≠mites)
                const nextFrame = currentFrame + direction;
                if (nextFrame >= 1 && nextFrame <= maxFrames) {
                    currentFrame = nextFrame;
                    setTimeout(animate, frameTime);
                } else {
                    console.log(`‚ö†Ô∏è Frame ${nextFrame} fuera de rango. Finalizando.`);
                    if (onComplete) onComplete();
                }
            };
            
            animate();
        }
        
        // ‚ú® EFECTOS ESPECIALES POR TIPO DE POKEBALL
        function createPokeballOpenEffects(ballType, position, pokemonName, isShiny) {
            if (!advancedEffects) {
                createBasicOpenEffect(position, ballType);
                return;
            }
            
            // üåü SI ES SHINY: Aplicar efectos shiny espec√≠ficos por pokeball
            if (isShiny) {
                const pokeballData = pokeballDatabase.find(p => p.id === ballType);
                // Efectos shiny personalizados (explosi√≥n dorada + color espec√≠fico de la pokeball)
                advancedEffects.createCustomShinyExplosion(position, pokeballData.color, ballType);
                setTimeout(() => {
                    advancedEffects.createShinyText(pokemonName);
                }, 500);
                
                // Si adem√°s es Master Ball, agregar efectos adicionales
                if (ballType === 'masterball') {
                    advancedEffects.createMasterBallStarsEffect(position);
                }
                return;
            }
            
            // üéæ EFECTOS NORMALES POR TIPO DE POKEBALL
            switch(ballType) {
                case 'masterball':
                    advancedEffects.createMasterBallStarsEffect(position);
                    break;
                    
                case 'ultraball':
                    createUltraBallEffect(position);
                    break;
                    
                case 'quickball':
                    createQuickBallEffect(position);
                    break;
                    
                case 'duskball':
                    createDuskBallEffect(position);
                    break;
                    
                case 'beastball':
                    createBeastBallEffect(position);
                    break;
                    
                case 'dreamball':
                    createDreamBallEffect(position);
                    break;
                    
                default:
                    createBasicOpenEffect(position, ballType);
                    break;
            }
        }
        
        // Efectos b√°sicos
        function createBasicOpenEffect(position, ballType) {
            const pokeballData = pokeballDatabase.find(p => p.id === ballType);
            const flash = document.createElement('div');
            flash.style.cssText = `
                position: fixed;
                left: ${position.x - 40}px;
                top: ${position.y - 40}px;
                width: 80px;
                height: 80px;
                background: radial-gradient(circle, ${pokeballData.color}66 0%, transparent 70%);
                border-radius: 50%;
                z-index: 999998;
                pointer-events: none;
                animation: flash-expand 1s ease-out forwards;
            `;
            
            document.body.appendChild(flash);
            setTimeout(() => flash.remove(), 1000);
        }
        
        // Efectos espec√≠ficos
        function createUltraBallEffect(position) {
            for(let i = 0; i < 8; i++) {
                const ray = document.createElement('div');
                const angle = i * 45;
                ray.style.cssText = `
                    position: fixed;
                    left: ${position.x}px;
                    top: ${position.y}px;
                    width: 100px;
                    height: 4px;
                    background: linear-gradient(90deg, #ffd700, transparent);
                    transform-origin: 0 50%;
                    transform: rotate(${angle}deg);
                    z-index: 999998;
                    pointer-events: none;
                    animation: ray-expand 1.2s ease-out forwards;
                `;
                document.body.appendChild(ray);
                setTimeout(() => ray.remove(), 1200);
            }
        }
        
        function createQuickBallEffect(position) {
            const lightning = document.createElement('div');
            lightning.style.cssText = `
                position: fixed;
                left: ${position.x - 50}px;
                top: ${position.y - 100}px;
                width: 100px;
                height: 200px;
                background: linear-gradient(180deg, #44ffff, #00ccff, transparent);
                clip-path: polygon(40% 0%, 60% 0%, 20% 50%, 80% 50%, 40% 100%, 60% 100%);
                z-index: 999998;
                pointer-events: none;
                animation: lightning-flash 0.5s ease-out forwards;
            `;
            document.body.appendChild(lightning);
            setTimeout(() => lightning.remove(), 500);
        }
        
        function createDuskBallEffect(position) {
            for(let i = 0; i < 6; i++) {
                const shadow = document.createElement('div');
                shadow.style.cssText = `
                    position: fixed;
                    left: ${position.x + (Math.random() - 0.5) * 200}px;
                    top: ${position.y + (Math.random() - 0.5) * 200}px;
                    width: 30px;
                    height: 30px;
                    background: rgba(68, 102, 68, 0.8);
                    border-radius: 50%;
                    z-index: 999998;
                    pointer-events: none;
                    animation: shadow-float 2s ease-out forwards;
                `;
                document.body.appendChild(shadow);
                setTimeout(() => shadow.remove(), 2000);
            }
        }
        
        function createBeastBallEffect(position) {
            for(let i = 0; i < 12; i++) {
                const particle = document.createElement('div');
                const angle = i * 30;
                particle.style.cssText = `
                    position: fixed;
                    left: ${position.x}px;
                    top: ${position.y}px;
                    width: 8px;
                    height: 8px;
                    background: #4444ff;
                    border-radius: 50%;
                    z-index: 999998;
                    pointer-events: none;
                    animation: beast-particle 1.5s ease-out forwards;
                    transform: rotate(${angle}deg);
                `;
                document.body.appendChild(particle);
                setTimeout(() => particle.remove(), 1500);
            }
        }
        
        function createDreamBallEffect(position) {
            for(let i = 0; i < 8; i++) {
                setTimeout(() => {
                    const dream = document.createElement('div');
                    dream.style.cssText = `
                        position: fixed;
                        left: ${position.x + (Math.random() - 0.5) * 150}px;
                        top: ${position.y + (Math.random() - 0.5) * 150}px;
                        width: 20px;
                        height: 20px;
                        background: rgba(255, 136, 204, 0.8);
                        border-radius: 50%;
                        z-index: 999998;
                        pointer-events: none;
                        animation: dream-float 3s ease-out forwards;
                    `;
                    document.body.appendChild(dream);
                    setTimeout(() => dream.remove(), 3000);
                }, i * 200);
            }
        }
        
        // Mostrar mensaje del pokemon
        function showPokemonMessage(pokemonName, isShiny) {
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0,0,0,0.8);
                color: white;
                padding: 20px 40px;
                border-radius: 10px;
                font-size: 18px;
                font-weight: bold;
                z-index: 1000000;
                text-align: center;
                border: 2px solid ${isShiny ? '#ffd700' : '#ffffff'};
                box-shadow: 0 0 20px rgba(0,0,0,0.5);
            `;
            
            message.innerHTML = `
                ${isShiny ? '‚ú®' : 'üêæ'} ${pokemonName} ${isShiny ? '(Shiny)' : ''} apareci√≥!<br>
                <small style="opacity: 0.7;">${isShiny ? 'WOW! ¬°Es un Pok√©mon shiny!' : 'Ha sido capturado exitosamente'}</small>
            `;
            
            document.body.appendChild(message);
            setTimeout(() => message.remove(), 2000);
        }
        
        // üéÆ TESTS ESPECIALES
        function testRandomPokeball() {
            const randomPokeball = pokeballDatabase[Math.floor(Math.random() * pokeballDatabase.length)];
            const pokemons = ['Pikachu', 'Charizard', 'Blastoise', 'Venusaur', 'Dragonite', 'Mewtwo', 'Rayquaza'];
            const randomPokemon = pokemons[Math.floor(Math.random() * pokemons.length)];
            const isShiny = Math.random() < 0.3;
            
            testPokeball(randomPokeball.id, randomPokemon, isShiny);
        }
        
        function testPokeballShowcase() {
            for(let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const randomPokeball = pokeballDatabase[Math.floor(Math.random() * pokeballDatabase.length)];
                    const position = {
                        x: (window.innerWidth / 6) * (i + 1),
                        y: window.innerHeight / 2 + (Math.random() - 0.5) * 200
                    };
                    createFrameByFramePokeballSequence(randomPokeball.id, position, `Demo ${i + 1}`, Math.random() < 0.2);
                }, i * 800);
            }
        }
        
        function testPokeballRain() {
            for(let i = 0; i < 10; i++) {
                setTimeout(() => {
                    const randomPokeball = pokeballDatabase[Math.floor(Math.random() * pokeballDatabase.length)];
                    const position = {
                        x: Math.random() * window.innerWidth,
                        y: Math.random() * window.innerHeight
                    };
                    createFrameByFramePokeballSequence(randomPokeball.id, position, 'Rain Pokemon', Math.random() < 0.15);
                }, i * 400);
            }
        }
        
        function testAllMainPokeballs() {
            const mainBalls = ['pokeball', 'greatball', 'ultraball', 'masterball'];
            mainBalls.forEach((ballType, index) => {
                setTimeout(() => {
                    const position = {
                        x: (window.innerWidth / (mainBalls.length + 1)) * (index + 1),
                        y: window.innerHeight / 2
                    };
                    testPokeball(ballType, `Main ${index + 1}`, index === 3);
                }, index * 1000);
            });
        }
        
        function testOnlyEffects() {
            const position = { x: window.innerWidth / 2, y: window.innerHeight / 2 };
            if (advancedEffects) {
                advancedEffects.createMasterBallStarsEffect(position);
            }
        }
        
        // üåü NUEVO: TEST SHOWCASE DE EFECTOS SHINY EN DIFERENTES POKEBALLS
        function testShinyEffectsShowcase() {
            console.log('üåü SHOWCASE: Efectos Shiny aplicados a diferentes pokeballs');
            
            // Seleccionar 6 pokeballs diferentes para mostrar los efectos shiny
            const showcaseBalls = [
                'pokeball',    // B√°sica
                'greatball',   // Azul
                'ultraball',   // Negra/dorada
                'masterball',  // P√∫rpura (con efectos adicionales)
                'luxuryball',  // Dorada
                'beastball'    // Azul oscura
            ];
            
            showcaseBalls.forEach((ballType, index) => {
                setTimeout(() => {
                    const position = {
                        x: (window.innerWidth / (showcaseBalls.length + 1)) * (index + 1),
                        y: window.innerHeight / 2 + (Math.random() - 0.5) * 100
                    };
                    
                    const pokeballData = pokeballDatabase.find(p => p.id === ballType);
                    const pokemonName = `${pokeballData.name.replace(' Ball', '')} Shiny`;
                    
                    console.log(`   üåü ${pokemonName} con efectos shiny universales`);
                    
                    // Todos con efectos shiny activados
                    createFrameByFramePokeballSequence(ballType, position, pokemonName, true);
                }, index * 600);
            });
            
            // Mensaje explicativo
            setTimeout(() => {
                const infoMessage = document.createElement('div');
                infoMessage.style.cssText = `
                    position: fixed;
                    top: 80px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: linear-gradient(135deg, rgba(255,215,0,0.9), rgba(255,140,0,0.9));
                    color: #000;
                    padding: 15px 25px;
                    border-radius: 10px;
                    font-size: 14px;
                    font-weight: bold;
                    text-align: center;
                    z-index: 1000000;
                    border: 2px solid #FFD700;
                    box-shadow: 0 0 20px rgba(255,215,0,0.5);
                `;
                infoMessage.innerHTML = `
                    ‚ú® EFECTOS SHINY PERSONALIZADOS ‚ú®<br>
                    <small style="opacity: 0.8;">Cada pokeball tiene su propio efecto shiny √∫nico basado en su color</small>
                `;
                
                document.body.appendChild(infoMessage);
                setTimeout(() => infoMessage.remove(), 4000);
            }, 500);
        }
        
        // ‚öîÔ∏è TEST: COMPARAR CAPTURA VS LIBERACI√ìN
        function testCaptureVsRelease() {
            console.log('‚öîÔ∏è COMPARANDO: Captura vs Liberaci√≥n');
            
            // LADO IZQUIERDO: Simulaci√≥n de CAPTURA (con shake)
            setTimeout(() => {
                const capturePosition = { x: window.innerWidth * 0.25, y: window.innerHeight / 2 };
                console.log('ü•Ö CAPTURA - Con shake lateral (agitaci√≥n)');
                testPokeballCapture('pokeball', 'Pikachu Salvaje', capturePosition);
            }, 500);
            
            // LADO DERECHO: LIBERACI√ìN normal (sin shake)
            setTimeout(() => {
                const releasePosition = { x: window.innerWidth * 0.75, y: window.innerHeight / 2 };
                console.log('üêæ LIBERACI√ìN - Sin shake (apertura suave)');
                testPokeball('pokeball', 'Pikachu Entrenado', false, releasePosition);
            }, 1500);
        }
        
        // ü•Ö SIMULACI√ìN DE CAPTURA (CON SHAKE)
        function testPokeballCapture(ballType, pokemonName, position) {
            const pokeballData = pokeballDatabase.find(p => p.id === ballType);
            
            // Crear sprite para captura
            const sprite = document.createElement('div');
            sprite.className = `pokeball-sprite-animated sprite-${ballType}`;
            sprite.style.cssText = `
                position: fixed;
                left: ${position.x - 20}px;
                top: ${position.y - 60}px;
                width: 41px;
                height: 40px;
                z-index: 999999;
                pointer-events: none;
                background-position: ${pokeballData.xPos}px 0px;
            `;
            document.body.appendChild(sprite);
            
            // SECUENCIA DE CAPTURA: Ca√≠da ‚Üí Shake ‚Üí (No apertura, se queda cerrada)
            sprite.style.animation = 'pokeball-fall 1.5s ease-out forwards';
            
            setTimeout(() => {
                // SHAKE DE CAPTURA
                console.log('üå™Ô∏è Agitaci√≥n de captura');
                sprite.style.animation = 'pokeball-shake 0.4s ease-in-out 6';
            }, 1500);
            
            setTimeout(() => {
                // Mensaje de captura exitosa
                const message = document.createElement('div');
                message.style.cssText = `
                    position: fixed;
                    top: ${position.y - 100}px;
                    left: ${position.x - 80}px;
                    background: rgba(0,0,0,0.8);
                    color: #00ff00;
                    padding: 10px 20px;
                    border-radius: 5px;
                    font-size: 14px;
                    z-index: 1000000;
                `;
                message.textContent = `ü•Ö ${pokemonName} capturado!`;
                document.body.appendChild(message);
                
                setTimeout(() => {
                    sprite.remove();
                    message.remove();
                }, 2000);
            }, 4000);
        }
        
        // CSS adicional para las animaciones
        const additionalCSS = `
            @keyframes flash-expand {
                0% { transform: scale(0); opacity: 1; }
                100% { transform: scale(3); opacity: 0; }
            }
            
            @keyframes ray-expand {
                0% { transform: scaleX(0) rotate(var(--angle)); opacity: 1; }
                100% { transform: scaleX(1) rotate(var(--angle)); opacity: 0; }
            }
            
            @keyframes lightning-flash {
                0% { opacity: 0; transform: scaleY(0); }
                50% { opacity: 1; transform: scaleY(1); }
                100% { opacity: 0; transform: scaleY(1); }
            }
            
            @keyframes shadow-float {
                0% { opacity: 0; transform: translateY(0); }
                50% { opacity: 0.8; transform: translateY(-20px); }
                100% { opacity: 0; transform: translateY(-40px); }
            }
            
            @keyframes beast-particle {
                0% { transform: translateX(0) scale(1); opacity: 1; }
                100% { transform: translateX(100px) scale(0); opacity: 0; }
            }
            
            @keyframes dream-float {
                0% { opacity: 0; transform: translateY(0) scale(0); }
                50% { opacity: 1; transform: translateY(-50px) scale(1); }
                100% { opacity: 0; transform: translateY(-100px) scale(0); }
            }
            
            /* üåü ANIMACIONES MASTER BALL */
            @keyframes masterBallPulse {
                0% { transform: scale(0); opacity: 1; }
                50% { transform: scale(1.2); opacity: 0.8; }
                100% { transform: scale(2); opacity: 0; }
            }
            
            @keyframes goldenStarBurst {
                0% { 
                    transform: scale(0) rotate(0deg); 
                    opacity: 1; 
                }
                50% { 
                    transform: scale(1.5) rotate(180deg); 
                    opacity: 1; 
                }
                100% { 
                    transform: scale(0.5) rotate(360deg); 
                    opacity: 0; 
                }
            }
            
            @keyframes purpleWave {
                0% { 
                    transform: scale(0); 
                    opacity: 0.8; 
                }
                100% { 
                    transform: scale(1.5); 
                    opacity: 0; 
                }
            }
            
            @keyframes sparklefall {
                0% { 
                    transform: translateY(0) rotate(0deg) scale(1); 
                    opacity: 1; 
                }
                100% { 
                    transform: translateY(200px) rotate(720deg) scale(0); 
                    opacity: 0; 
                }
            }
            
            @keyframes shinyExplosion {
                0% { 
                    transform: scale(0); 
                    opacity: 1; 
                }
                50% { 
                    transform: scale(1.5); 
                    opacity: 0.9; 
                }
                100% { 
                    transform: scale(3); 
                    opacity: 0; 
                }
            }
            
            @keyframes shinyTextGlow {
                0% { 
                    transform: translateX(-50%) scale(0); 
                    opacity: 0; 
                }
                20% { 
                    transform: translateX(-50%) scale(1.2); 
                    opacity: 1; 
                }
                80% { 
                    transform: translateX(-50%) scale(1); 
                    opacity: 1; 
                }
                100% { 
                    transform: translateX(-50%) scale(0.8); 
                    opacity: 0; 
                }
            }
        `;
        
        const styleSheet = document.createElement('style');
        styleSheet.textContent = additionalCSS;
        document.head.appendChild(styleSheet);

        // üîç HERRAMIENTA DE MEDICI√ìN DE SPRITES
        function measureSpritesheet() {
            console.log('üîç SPRITE MEASUREMENT TOOL');
            console.log('========================');
            
            // Crear imagen temporal para medir
            const testImg = new Image();
            testImg.onload = function() {
                const width = this.naturalWidth;
                const height = this.naturalHeight;
                
                console.log(`üìê Spritesheet Total Size: ${width}x${height}px`);
                console.log(`üìê Pokeballs (columns): ${Math.floor(width / 41)} sprites`);
                console.log(`üìê Frames (rows): ${Math.floor(height / 40)} frames`);
                console.log(`üìê Individual Sprite Size: 41x40px`);
                console.log('');
                
                // AUTO-CORRECCI√ìN: Actualizar background-size din√°micamente
                const correctSize = `${width}px ${height}px`;
                console.log(`üîß CORRECCI√ìN AUTOM√ÅTICA:`);
                console.log(`   background-size actual: 1106px 680px`);
                console.log(`   background-size correcto: ${correctSize}`);
                
                // Actualizar todos los elementos con la clase pokeball-icon
                const icons = document.querySelectorAll('.pokeball-icon, .pokeball-sprite-animated');
                icons.forEach(icon => {
                    icon.style.backgroundSize = correctSize;
                });
                
                console.log(`‚úÖ Se actualizaron ${icons.length} elementos con el tama√±o correcto`);
                
                // Calcular todas las posiciones
                const pokeballs = Math.floor(width / 41);
                const frames = Math.floor(height / 40);
                
                console.log('üéØ HORIZONTAL POSITIONS (Pokeballs):');
                for(let i = 0; i < Math.min(pokeballs, 10); i++) {
                    const xPos = -41 * i;
                    console.log(`   Column ${i + 1}: ${xPos}px`);
                }
                
                console.log('');
                console.log('üéØ VERTICAL POSITIONS (Animation Frames):');
                for(let i = 0; i < Math.min(frames, 11); i++) {
                    const yPos = -40 * i;
                    console.log(`   Frame ${i + 1}: ${yPos}px`);
                }
                
                console.log('');
                console.log('üí° USO:');
                console.log('   background-position: [xPos]px [yPos]px;');
                console.log('   Ejemplo: background-position: -82px -120px; (pokeball 3, frame 4)');
            };
            testImg.onerror = function() {
                console.error('‚ùå ERROR: No se pudo cargar el spritesheet');
                console.error('   Verifica que el archivo existe en: resources/sprites/pokeball-sprites-oficial.png');
            };
            testImg.src = 'resources/sprites/pokeball-sprites-oficial.png';
        }
        
        // üß™ FUNCI√ìN DE TEST DE MEDICI√ìN
        function testSpritePositions() {
            console.log('üß™ TESTING SPRITE POSITIONS');
            console.log('==========================');
            
            // Crear sprite de prueba
            const testSprite = document.createElement('div');
                         testSprite.style.cssText = `
                 position: fixed;
                 top: 50px;
                 left: 50px;
                 width: 41px;
                 height: 40px;
                 background-image: url('resources/sprites/pokeball-sprites-oficial.png');
                 background-size: 1106px 680px;
                 border: 2px solid red;
                 z-index: 999999;
             `;
            document.body.appendChild(testSprite);
            
            let currentCol = 0;
            let currentRow = 0;
            const maxCols = 27;  // 27 pokeballs horizontalmente
            const maxRows = 11;  // 11 frames por pokeball verticalmente
            
            console.log('‚å®Ô∏è CONTROLES:');
            console.log('   ‚Üê ‚Üí : Cambiar pokeball (columna)');
            console.log('   ‚Üë ‚Üì : Cambiar frame (fila)');
            console.log('   ESC : Cerrar test');
            
            function updateSprite() {
                const xPos = -41 * currentCol;
                const yPos = -40 * currentRow;
                testSprite.style.backgroundPosition = `${xPos}px ${yPos}px`;
                console.log(`üìç Col: ${currentCol + 1}/${maxCols}, Row: ${currentRow + 1}/${maxRows} | Position: ${xPos}px ${yPos}px`);
            }
            
            // Controles de teclado
            function handleKeyPress(e) {
                switch(e.key) {
                    case 'ArrowLeft':
                        currentCol = Math.max(0, currentCol - 1);
                        updateSprite();
                        break;
                    case 'ArrowRight':
                        currentCol = Math.min(maxCols - 1, currentCol + 1);
                        updateSprite();
                        break;
                    case 'ArrowUp':
                        currentRow = Math.max(0, currentRow - 1);
                        updateSprite();
                        break;
                    case 'ArrowDown':
                        currentRow = Math.min(maxRows - 1, currentRow + 1);
                        updateSprite();
                        break;
                    case 'Escape':
                        testSprite.remove();
                        document.removeEventListener('keydown', handleKeyPress);
                        console.log('‚úÖ Sprite test closed');
                        break;
                }
            }
            
            document.addEventListener('keydown', handleKeyPress);
            updateSprite();
        }
        
        // üìã MOSTRAR ESTRUCTURA DEL SPRITESHEET
        function showSpritesheetStructure() {
            console.log('üìã ESTRUCTURA DEL SPRITESHEET');
            console.log('=============================');
            console.log('');
            console.log('üìê DIMENSIONES:');
            console.log('   ‚Ä¢ 27 columnas (pokeballs diferentes)');
            console.log('   ‚Ä¢ 11 filas (frames de animaci√≥n por pokeball)');
            console.log('   ‚Ä¢ Tama√±o individual: 41x40px');
            console.log('   ‚Ä¢ Tama√±o total esperado: 1106x680px');
            console.log('');
            console.log('üóÇÔ∏è ESTRUCTURA:');
            console.log('   Columna 1  Columna 2  Columna 3  ...  Columna 27');
            console.log('   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê');
            console.log('   ‚îÇ Frame 1 ‚îÇ Frame 1 ‚îÇ Frame 1 ‚îÇ ... ‚îÇ Frame 1 ‚îÇ');
            console.log('   ‚îÇ Frame 2 ‚îÇ Frame 2 ‚îÇ Frame 2 ‚îÇ ... ‚îÇ Frame 2 ‚îÇ');
            console.log('   ‚îÇ Frame 3 ‚îÇ Frame 3 ‚îÇ Frame 3 ‚îÇ ... ‚îÇ Frame 3 ‚îÇ');
            console.log('   ‚îÇ   ...   ‚îÇ   ...   ‚îÇ   ...   ‚îÇ ... ‚îÇ   ...   ‚îÇ');
            console.log('   ‚îÇFrame 11 ‚îÇFrame 11 ‚îÇFrame 11 ‚îÇ ... ‚îÇFrame 11 ‚îÇ');
            console.log('   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò');
            console.log('');
            console.log('üéØ CADA POKEBALL TIENE:');
            console.log('   ‚Ä¢ Frame 1: Cerrada (0px vertical)');
            console.log('   ‚Ä¢ Frame 2: Empezando a abrir (-40px)');
            console.log('   ‚Ä¢ Frame 3: M√°s abierta (-80px)');
            console.log('   ‚Ä¢ Frame 4-10: Progresi√≥n de apertura');
            console.log('   ‚Ä¢ Frame 11: Completamente abierta (-400px)');
            console.log('');
            console.log('üí° IMPORTANTE:');
            console.log('   ‚úÖ Solo usar frames 1-11 por pokeball');
            console.log('   ‚ùå No usar frames superiores al 11');
            console.log('   ‚úÖ Animaci√≥n: 1‚Üí11 (apertura), 11‚Üí1 (cierre)');
        }
    </script>
</body>
</html>
